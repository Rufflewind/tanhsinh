<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.9.1"/>
<title>tanhsinh: tanhsinh.c Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">tanhsinh
   </div>
   <div id="projectbrief">Numerical integration using tanh-sinh quadrature</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.9.1 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">tanhsinh.c</div>  </div>
</div><!--header-->
<div class="contents">
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="preprocessor">#include &lt;float.h&gt;</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="preprocessor">#include &lt;limits.h&gt;</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="preprocessor">#include &lt;math.h&gt;</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="preprocessor">#include &lt;stddef.h&gt;</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="tanhsinh_8h.html">tanhsinh.h</a>&quot;</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="preprocessor">#ifdef __cplusplus</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="keyword">extern</span> <span class="stringliteral">&quot;C&quot;</span> {</div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;</div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">The double exponential rule is based on the observation that the trapezoid rule converges</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">very rapidly for functions on the entire real line that go to zero like exp(-exp(t)).</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">The change of variables x = tanh(pi sinh(t)/2) transforms an integral over [-1, 1]</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment">into an integral with integrand suited to the double exponential rule.</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment">The transformed integral is infinite, but we truncate the domain of integration to [-3, 3].</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment">The limit &#39;3&#39; was chosen for two reasons: for t = 3, the transformed x values</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment">are nearly equal to 1 for 12 or more significant figures.  Also, for t = 3, the</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment">smallest weights are 12 orders of magnitude smaller than the largest weights; setting</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment">the cutoff larger than 3 would not have a significant impact on the integral value</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment">unless there is a strong singularity at one of the end points.</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment">The change of variables x(t) is an odd function, i.e. x(-t) = -x(t), and so we need only</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment">store the positive x values.  Also, the derivative w(t) = x&#39;(t) is even, i.e. w(-t) = w(t),</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="comment">and so we need only store the weights corresponding to positive values of x.</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="comment">The integration first applies the trapezoid rule to [-3, 3] in steps of size 1.</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="comment">Then it subsequently cuts the step size in half each time, comparing the results.</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="comment">Integration stops when subsequent iterations are close enough together or the maximum</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="comment">integration points have been used.</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="comment">By cutting h in half, the previous integral can be reused; we only need evaluate the</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="comment">integrand at the newly added points.</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="comment">Finally, note that we&#39;re not strictly using the trapezoid rule: we don&#39;t treat the</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="comment">end points differently.  This is because we assume the values at the ends of the interval</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="comment">hardly matter due to the rapid decay of the integrand.</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="comment">All values below were calculated with Mathematica.</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="comment">*/</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">double</span> nodes[] = {</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    <span class="comment">/* 1st layer nodes: transformed 0, 1, 2, 3 */</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    0.00000000000000000000,</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    0.95136796407274694573,</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    0.99997747719246159286,</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    0.99999999999995705839,</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    <span class="comment">/* 2nd layer nodes: transformed 1/2, 3/2, 5/2 */</span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    0.67427149224843582608,</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    0.99751485645722438683,</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;    0.99999998887566488198,</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    <span class="comment">/* 3rd layer nodes: transformed 1/4, 3/4, ... */</span></div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    0.37720973816403417379,</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    0.85956905868989663517,</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    0.98704056050737689169,</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    0.99968826402835320905,</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    0.99999920473711471266,</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    0.99999999995285644818,</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    <span class="comment">/* 4th layer nodes: transformed 1/8, 3/8, ... */</span></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    0.19435700332493543161,</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    0.53914670538796776905,</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    0.78060743898320029925,</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    0.91487926326457461091,</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    0.97396686819567744856,</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    0.99405550663140214329,</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    0.99906519645578584642,</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    0.99990938469514399984,</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    0.99999531604122052843,</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    0.99999989278161241838,</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    0.99999999914270509218,</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    0.99999999999823216531,</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    <span class="comment">/* 5th layer node: transformed 1/16, 3/16, ... */</span></div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    0.097923885287832333262,</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    0.28787993274271591456,</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    0.46125354393958570440,</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    0.61027365750063894488,</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    0.73101803479256151149,</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    0.82331700550640237006,</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    0.88989140278426019808,</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    0.93516085752198468323,</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    0.96411216422354729193,</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    0.98145482667733517003,</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    0.99112699244169880223,</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;    0.99610866543750854254,</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    0.99845420876769773751,</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    0.99945143443527460584,</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    0.99982882207287494166,</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    0.99995387100562796075,</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    0.99998948201481850361,</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    0.99999801714059543208,</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    0.99999969889415261122,</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    0.99999996423908091534,</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    0.99999999678719909830,</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    0.99999999978973286224,</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    0.99999999999039393352,</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    0.99999999999970809734,</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    <span class="comment">/* 6th layer nodes: transformed 1/32, 3/32, ... */</span></div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    0.049055967305077886315,</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    0.14641798429058794053,</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    0.24156631953888365838,</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    0.33314226457763809244,</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    0.41995211127844715849,</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    0.50101338937930910152,</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    0.57558449063515165995,</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    0.64317675898520470128,</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    0.70355000514714201566,</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    0.75669390863372994941,</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    0.80279874134324126576,</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    0.84221924635075686382,</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    0.87543539763040867837,</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    0.90301328151357387064,</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    0.92556863406861266645,</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    0.94373478605275715685,</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    0.95813602271021369012,</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    0.96936673289691733517,</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    0.97797623518666497298,</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    0.98445883116743083087,</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    0.98924843109013389601,</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    0.99271699719682728538,</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    0.99517602615532735426,</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;    0.99688031812819187372,</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;    0.99803333631543375402,</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    0.99879353429880589929,</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    0.99928111192179195541,</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    0.99958475035151758732,</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    0.99976797159956083506,</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    0.99987486504878034648,</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    0.99993501992508242369,</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    0.99996759306794345976,</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    0.99998451990227082442,</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    0.99999293787666288565,</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    0.99999693244919035751,</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    0.99999873547186590954,</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    0.99999950700571943689,</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    0.99999981889371276701,</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;    0.99999993755407837378,</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;    0.99999997987450320175,</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    0.99999999396413420165,</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    0.99999999832336194826,</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    0.99999999957078777261,</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    0.99999999989927772326,</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    0.99999999997845533741,</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    0.99999999999582460688,</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;    0.99999999999927152627,</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;    0.99999999999988636130,</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;    <span class="comment">/* 7th layer nodes: transformed 1/64, 3/64, ... */</span></div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    0.024539763574649160379,</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    0.073525122985671294475,</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    0.12222912220155764235,</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    0.17046797238201051811,</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    0.21806347346971200463,</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    0.26484507658344795046,</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;    0.31065178055284596083,</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    0.35533382516507453330,</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    0.39875415046723775644,</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;    0.44078959903390086627,</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;    0.48133184611690504422,</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;    0.52028805069123015958,</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    0.55758122826077823080,</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    0.59315035359195315880,</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;    0.62695020805104287950,</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    0.65895099174335012438,</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    0.68913772506166767176,</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    0.71750946748732412721,</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    0.74407838354734739913,</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    0.76886868676824658459,</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    0.79191549237614211447,</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    0.81326360850297385168,</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    0.83296629391941087564,</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    0.85108400798784873261,</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    0.86768317577564598669,</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    0.88283498824466895513,</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    0.89661425428007602579,</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;    0.90909831816302043511,</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;    0.92036605303195280235,</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    0.93049693799715340631,</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;    0.93957022393327475539,</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    0.94766419061515309734,</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    0.95485549580502268541,</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    0.96121861515111640753,</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    0.96682537031235585284,</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;    0.97174454156548730892,</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    0.97604156025657673933,</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    0.97977827580061576265,</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    0.98301279148110110558,</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    0.98579936302528343597,</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    0.98818835380074264243,</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    0.99022624046752774694,</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    0.99195566300267761562,</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    0.99341551316926403900,</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    0.99464105571251119672,</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;    0.99566407681695316965,</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;    0.99651305464025377317,</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;    0.99721334704346870224,</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    0.99778739195890653083,</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    0.99825491617199629344,</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;    0.99863314864067747762,</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    0.99893703483351217373,</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;    0.99917944893488591716,</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    0.99937140114093768690,</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    0.99952223765121720422,</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    0.99963983134560036519,</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;    0.99973076151980848263,</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    0.99980048143113838630,</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;    0.99985347277311141171,</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;    0.99989338654759256426,</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;    0.99992317012928932869,</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    0.99994518061445869309,</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    0.99996128480785666613,</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;    0.99997294642523223656,</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;    0.99998130127012072679,</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;    0.99998722128200062811,</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    0.99999136844834487344,</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    0.99999423962761663478,</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;    0.99999620334716617675,</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;    0.99999752962380516793,</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    0.99999841381096473542,</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    0.99999899541068996962,</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    0.99999937270733536947,</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;    0.99999961398855024275,</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;    0.99999976602333243312,</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;    0.99999986037121459941,</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    0.99999991800479471056,</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;    0.99999995264266446185,</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;    0.99999997311323594362,</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;    0.99999998500307631173,</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    0.99999999178645609907,</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;    0.99999999558563361584,</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;    0.99999999767323673790,</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;    0.99999999879798350040,</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;    0.99999999939177687583,</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;    0.99999999969875436925,</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;    0.99999999985405611550,</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    0.99999999993088839501,</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;    0.99999999996803321674,</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;    0.99999999998556879008,</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;    0.99999999999364632387,</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;    0.99999999999727404948,</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;    0.99999999999886126543,</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;    0.99999999999953722654,</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;    0.99999999999981720098,</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;    0.99999999999992987953</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;};</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">double</span> weights[] = {</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;    <span class="comment">/* First layer weights */</span></div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;    1.5707963267948966192,</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    0.230022394514788685,</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;    0.00026620051375271690866,</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;    1.3581784274539090834e-12,</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;    <span class="comment">/* 2nd layer weights */</span></div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;    0.96597657941230114801,</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;    0.018343166989927842087,</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;    2.1431204556943039358e-7,</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;    <span class="comment">/* 3rd layer weights */</span></div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;    1.3896147592472563229,</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;    0.53107827542805397476,</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;    0.076385743570832304188,</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;    0.0029025177479013135936,</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;    0.000011983701363170720047,</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;    1.1631165814255782766e-9,</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;    <span class="comment">/* 4th layer weights */</span></div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;    1.5232837186347052132,</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;    1.1934630258491569639,</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;    0.73743784836154784136,</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;    0.36046141846934367417,</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;    0.13742210773316772341,</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;    0.039175005493600779072,</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;    0.0077426010260642407123,</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;    0.00094994680428346871691,</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;    0.000062482559240744082891,</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;    1.8263320593710659699e-6,</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;    1.8687282268736410132e-8,</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;    4.9378538776631926964e-11,</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;    <span class="comment">/*  5th layer weights */</span></div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;    1.5587733555333301451,</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;    1.466014426716965781,</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;    1.297475750424977998,</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;    1.0816349854900704074,</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;    0.85017285645662006895,</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;    0.63040513516474369106,</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;    0.44083323627385823707,</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;    0.290240679312454185,</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;    0.17932441211072829296,</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;    0.10343215422333290062,</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;    0.055289683742240583845,</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;    0.027133510013712003219,</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;    0.012083543599157953493,</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;    0.0048162981439284630173,</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;    0.0016908739981426396472,</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;    0.00051339382406790336017,</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;    0.00013205234125609974879,</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;    0.000028110164327940134749,</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;    4.8237182032615502124e-6,</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;    6.4777566035929719908e-7,</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;    6.5835185127183396672e-8,</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;    4.8760060974240625869e-9,</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;    2.5216347918530148572e-10,</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;    8.6759314149796046502e-12,</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;    <span class="comment">/* 6th layer weights */</span></div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;    1.5677814313072218572,</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;    1.5438811161769592204,</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;    1.4972262225410362896,</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;    1.4300083548722996676,</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;    1.3452788847662516615,</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;    1.2467012074518577048,</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;    1.1382722433763053734,</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;    1.0240449331118114483,</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;    0.90787937915489531693,</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;    0.79324270082051671787,</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;    0.68306851634426375464,</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;    0.57967810308778764708,</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;    0.48475809121475539287,</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;    0.39938474152571713515,</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;    0.32408253961152890402,</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;    0.258904639514053516,</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;    0.20352399885860174519,</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;    0.15732620348436615027,</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;    0.11949741128869592428,</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;    0.089103139240941462841,</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;    0.065155533432536205042,</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;    0.046668208054846613644,</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;    0.032698732726609031113,</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;    0.022379471063648476483,</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;    0.014937835096050129696,</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;    0.0097072237393916892692,</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;    0.0061300376320830301252,</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;    0.0037542509774318343023,</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;    0.0022250827064786427022,</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;    0.0012733279447082382027,</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;    0.0007018595156842422708,</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;    0.00037166693621677760301,</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;    0.00018856442976700318572,</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;    0.000091390817490710122732,</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;    0.000042183183841757600604,</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;    0.000018481813599879217116,</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;    7.6595758525203162562e-6,</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;    2.9916615878138787094e-6,</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;    1.0968835125901264732e-6,</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;    3.7595411862360630091e-7,</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;    1.1992442782902770219e-7,</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;    3.5434777171421953043e-8,</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;    9.6498888961089633609e-9,</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;    2.4091773256475940779e-9,</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;    5.482835779709497755e-10,</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;    1.1306055347494680536e-10,</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;    2.0989335404511469109e-11,</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;    3.4841937670261059685e-12,</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;    <span class="comment">/* 7th layer weights */</span></div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;    1.5700420292795931467,</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;    1.5640214037732320999,</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;    1.5520531698454121192,</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;    1.5342817381543034316,</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;    1.5109197230741697127,</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;    1.48224329788553807,</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;    1.4485862549613225916,</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;    1.4103329714462590129,</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;    1.3679105116808964881,</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;    1.3217801174437728579,</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;    1.2724283455378627082,</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;    1.2203581095793582207,</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;    1.1660798699324345766,</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;    1.1101031939653403796,</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;    1.0529288799552666556,</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;    0.99504180404613271514,</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;    0.93690461274566793366,</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;    0.87895234555278212039,</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;    0.82158803526696470334,</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;    0.7651792989089561367,</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;    0.71005590120546898385,</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;    0.65650824613162753076,</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;    0.60478673057840362158,</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;    0.55510187800363350959,</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;    0.5076251588319080997,</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;    0.4624903980553677613,</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;    0.41979566844501548066,</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;    0.37960556938665160999,</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;    0.3419537959230168323,</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;    0.30684590941791694932,</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;    0.27426222968906810637,</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;    0.24416077786983990868,</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;    0.21648020911729617038,</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;    0.19114268413342749532,</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;    0.16805663794826916233,</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;    0.14711941325785693248,</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;    0.12821973363120098675,</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;    0.11123999898874453035,</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;    0.096058391865189467849,</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;    0.082550788110701737654,</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;    0.070592469906866999352,</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;    0.060059642358636300319,</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;    0.05083075757257047107,</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;    0.042787652157725676034,</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;    0.035816505604196436523,</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;    0.029808628117310126969,</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;    0.024661087314753282511,</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;    0.020277183817500123926,</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;    0.016566786254247575375,</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;    0.013446536605285730674,</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;    0.010839937168255907211,</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;    0.0086773307495391815854,</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;    0.0068957859690660035329,</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;    0.0054388997976239984331,</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;    0.0042565295990178580165,</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;    0.0033044669940348302363,</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;    0.0025440657675291729678,</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;    0.0019418357759843675814,</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;    0.0014690143599429791058,</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;    0.0011011261134519383862,</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;    0.00081754101332469493115,</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;    0.00060103987991147422573,</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;    0.00043739495615911687786,</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;    0.00031497209186021200274,</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;    0.00022435965205008549104,</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;    0.00015802788400701191949,</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;    0.00011002112846666697224,</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;    0.000075683996586201477788,</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;    0.000051421497447658802092,</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;    0.0000344921247593431977,</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;    0.000022832118109036146591,</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;    0.000014908514031870608449,</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;    9.5981941283784710776e-6,</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;    6.0899100320949039256e-6,</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;    3.8061983264644899045e-6,</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;    2.3421667208528096843e-6,</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;    1.4183067155493917523e-6,</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;    8.4473756384859863469e-7,</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;    4.9458288702754198508e-7,</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;    2.8449923659159806339e-7,</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;    1.6069394579076224911e-7,</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;    8.9071395140242387124e-8,</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;    4.8420950198072369669e-8,</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;    2.579956822953589238e-8,</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;    1.3464645522302038796e-8,</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;    6.8784610955899001111e-9,</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;    3.4371856744650090511e-9,</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;    1.6788897682161906807e-9,</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;    8.0099784479729665356e-10,</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;    3.7299501843052790038e-10,</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;    1.6939457789411646876e-10,</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;    7.4967397573818224522e-11,</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;    3.230446433325236576e-11,</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;    1.3542512912336274432e-11,</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;    5.5182369468174885821e-12,</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;    2.1835922099233609052e-12</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;};</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;<span class="comment">/* Offsets to where each level&#39;s integration constants start.</span></div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;<span class="comment">   The last element is not a beginning but an end. */</span></div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">size_t</span> offsets[] = {1, 4, 7, 13, 25, 49, 97, 193};</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">size_t</span> num_levels = <span class="keyword">sizeof</span>(offsets) / <span class="keyword">sizeof</span>(*offsets) - 1;</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;<span class="comment">/* Integrate f(c x + d) with the given integration constants. */</span></div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;<span class="keyword">static</span> <span class="keywordtype">double</span> integrate(<span class="keywordtype">double</span> f(<span class="keywordtype">double</span> x, <span class="keywordtype">void</span> *ctx), <span class="keywordtype">void</span> *ctx,</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;                        <span class="keywordtype">double</span> c, <span class="comment">/* slope     of change of variables */</span></div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;                        <span class="keywordtype">double</span> d, <span class="comment">/* intercept of change of variables */</span></div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;                        <span class="keywordtype">double</span> abs_err, <span class="keywordtype">double</span> *est_err, <span class="keywordtype">unsigned</span> *num_eval)</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;{</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;    <span class="keywordtype">size_t</span> i, level;</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;    <span class="keywordtype">double</span></div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;        prev_delta,</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;        curr_delta   = DBL_MAX,</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;        curr_est_err = DBL_MAX,</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;        new_contrib  = 0.,</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;        integral     = 0.,</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;        dx           = 1.;</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;    abs_err *= c;</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;    integral = f(c * nodes[0] + d, ctx) * weights[0];</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;    <span class="keywordflow">for</span> (i = offsets[0]; i != offsets[1]; ++i)</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;        integral += weights[i] * (f( c * nodes[i] + d, ctx) +</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;                                  f(-c * nodes[i] + d, ctx));</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;    <span class="keywordflow">for</span> (level = 1; level != num_levels; ++level) {</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;        <span class="keywordtype">double</span> r;</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;        dx *= .5;</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;        new_contrib = 0.;</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;        <span class="keywordflow">for</span> (i = offsets[level]; i != offsets[level + 1]; ++i)</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;            new_contrib += weights[i] * (f( c * nodes[i] + d, ctx) +</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;                                         f(-c * nodes[i] + d, ctx));</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;        new_contrib *= dx;</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;        <span class="comment">/* difference in consecutive integral estimates */</span></div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;        prev_delta = curr_delta;</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;        curr_delta = fabs(.5 * integral - new_contrib);</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;        integral = .5 * integral + new_contrib;</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;        <span class="comment">/* Once convergence kicks in, error is approximately squared at each</span></div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;<span class="comment">           step.  Determine whether we&#39;re in the convergent region by looking</span></div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;<span class="comment">           at the trend in the error. */</span></div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;        <span class="keywordflow">if</span> (level == 1)</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;            <span class="comment">/* prev_delta meaningless, so cannot check convergence. */</span></div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;        <span class="comment">/* Exact comparison with zero is harmless here.  Could possibly be</span></div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;<span class="comment">           replaced with a small positive upper limit on the size of</span></div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;<span class="comment">           curr_delta, but determining that upper limit would be difficult.</span></div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;<span class="comment">           At worse, the loop is executed more times than necessary.  But no</span></div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;<span class="comment">           infinite loop can result since there is an upper bound on the loop</span></div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;<span class="comment">           variable. */</span></div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;        <span class="keywordflow">if</span> (!curr_delta)</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;        <span class="comment">/* prev_delta != 0 or would have been kicked out previously */</span></div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;        r = log(curr_delta) / log(prev_delta);</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;        <span class="keywordflow">if</span> (r &gt; 1.9 &amp;&amp; r &lt; 2.1)</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;            <span class="comment">/* If convergence theory applied perfectly, r would be 2 in the</span></div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;<span class="comment">               convergence region.  r close to 2 is good enough. We expect the</span></div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;<span class="comment">               difference between this integral estimate and the next one to</span></div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;<span class="comment">               be roughly delta^2. */</span></div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;            curr_est_err = curr_delta * curr_delta;</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;            <span class="comment">/* Not in the convergence region.  Assume only that error is</span></div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;<span class="comment">               decreasing. */</span></div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;            curr_est_err = curr_delta;</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;        <span class="keywordflow">if</span> (curr_est_err &lt; .1 * abs_err)</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;    }</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;    <span class="keywordflow">if</span> (num_eval) {</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">size_t</span> actual_num_eval = 2 * i - 1;</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;        *num_eval = (unsigned)actual_num_eval;</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;        <span class="comment">/* Deal with potential overflow. */</span></div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;        <span class="keywordflow">if</span> ((<span class="keywordtype">size_t</span>)*num_eval != actual_num_eval)</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;            *num_eval = UINT_MAX;</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;    }</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;    <span class="keywordflow">if</span> (est_err)</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;        *est_err = curr_est_err * c;</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;    <span class="keywordflow">return</span> c * integral;</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;}</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;</div>
<div class="line"><a name="l00534"></a><span class="lineno"><a class="line" href="tanhsinh_8h.html#a57c2d34578d6844930101717c2e04a20">  534</a></span>&#160;<span class="keywordtype">double</span> <a class="code" href="tanhsinh_8h.html#a57c2d34578d6844930101717c2e04a20">tanhsinh_quad</a>(<span class="keywordtype">double</span> f(<span class="keywordtype">double</span> x, <span class="keywordtype">void</span> *ctx), <span class="keywordtype">void</span> *ctx,</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;                     <span class="keywordtype">double</span> a, <span class="keywordtype">double</span> b, <span class="keywordtype">double</span> abs_err,</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;                     <span class="keywordtype">double</span> *est_err, <span class="keywordtype">unsigned</span> *num_eval)</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;{</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;    <span class="comment">/* Apply the linear change of variables x = c t + d:</span></div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;<span class="comment">       integral[a, b] f(x) dx = c int[-1; 1] f(c t + d) dt,</span></div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;<span class="comment">       where c = (b - a) / 2 and d = (a + b) / 2. */</span></div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;    <span class="keywordflow">return</span> integrate(f, ctx, .5 * (b - a), .5 * (b + a),</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;                     abs_err, est_err, num_eval);</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;}</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;<span class="preprocessor">#ifdef __cplusplus</span></div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;}</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="ttc" id="tanhsinh_8h_html_a57c2d34578d6844930101717c2e04a20"><div class="ttname"><a href="tanhsinh_8h.html#a57c2d34578d6844930101717c2e04a20">tanhsinh_quad</a></div><div class="ttdeci">double tanhsinh_quad(double f(double x, void *ctx), void *ctx, double a, double b, double abs_err, double *est_err, unsigned *num_eval)</div><div class="ttdoc">Integrate an analytic function over a finite interval. </div><div class="ttdef"><b>Definition:</b> <a href="tanhsinh_8c_source.html#l00534">tanhsinh.c:534</a></div></div>
<div class="ttc" id="tanhsinh_8h_html"><div class="ttname"><a href="tanhsinh_8h.html">tanhsinh.h</a></div><div class="ttdoc">Numerical integration in one dimension using the tanh-sinh quadrature. </div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Sat May 2 2015 07:10:54 for tanhsinh by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.9.1
</small></address>
</body>
</html>
